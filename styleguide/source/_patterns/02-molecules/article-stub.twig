{% set link = articleStub.title %}
{% set classes = [
articleStub.related ? "ama__article-stub--related",
articleStub.small ? "ama__article-stub--small"
] %}

{% macro mediaType(articleStub) %}
  {% if articleStub.video or articleStub.image %}
    {% if articleStub.video %}
      {% set video = article_mediaType %}
      {% include "@atoms/video.twig" %}
    {% else %}
      {% set image = articleStub.image %}
      {% include "@atoms/image.twig"  with { 'class': 'ama__image'} %}
    {% endif %}
  {% endif %}
{% endmacro %}

{% macro description(articleStub) %}
  {% set title = articleStub.title_only %}
  {% set related = articleStub.related %}
  {% set link = articleStub.link %}
  {% set paragraph = articleStub.paragraph %}

  {% if paragraph and not title %}
    <div class="ama__article-stub__description">
      {% include "@atoms/paragraph.twig" %}
    </div>
  {% endif %}
{% endmacro %}

{% macro metadata(articleStub) %}
  {% set metadata, paragraph, title_only = articleStub.metadata, articleStub.paragraph, articleStub.title_only%}
  {% if metadata and paragraph and not title_only %}
    {% include "@molecules/article-metadata.twig" %}
  {% endif %}
{% endmacro %}

{#Show only title#}
{% macro title(article_title) %}
  {% set link = article_title.link %}
  {% if link %}
    {% if article_title.related %}
      {% include "@atoms/link.twig" %}
    {% else %}
      <h2>
        {% include "@atoms/link.twig" %}
      </h2>
    {% endif %}
  {% endif %}
{% endmacro %}

<div class="ama__article-stub {{ classes|join(' ') }}">
  {% block articleStub_media %}
    {{ _self.mediaType(articleStub) }}
  {% endblock %}

  <div class="ama__article-stub__copy">
    {% block articleStub_title %}
      {{ _self.title(articleStub) }}
    {% endblock %}

    {% block articleStub_description %}
      {{ _self.description(articleStub) }}
    {% endblock %}

    <div class="ama__article-stub__metadata">
      {% block articleStub_metadata %}
        {{ _self.metadata(articleStub) }}
      {% endblock %}
    </div>
  </div>
</div>
